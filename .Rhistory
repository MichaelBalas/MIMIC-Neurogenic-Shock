library(bnlearn)
library(Rgraphviz)
library(fmsb)
library(pROC)
data <- read.csv("Master_Tables/MASTER_TABLE.csv", header=TRUE)
no_shock_data = (subset(data, data$IN_SHOCK == 0))
shock_data = (subset(data, data$IN_SHOCK == 1))
## --- GENERALIZED LINEAR MODELS ---
fit_dead = glm(formula = DEAD ~ . - HADM_ID - ICUSTAY_ID - LOS_HOSPITAL - LOS_ICU - IN_SHOCK -
MULTIPLE_SCI - COMORBIDITIES, family = binomial, data=shock_data)
summary(fit_dead)
fit_los = glm(formula = LOS_ICU ~ . - HADM_ID - ICUSTAY_ID - LOS_HOSPITAL - DEAD - IN_SHOCK -
MULTIPLE_SCI - COMORBIDITIES, family = gaussian, data=shock_data)
summary(fit_los)
## --- NAGELKERKE R^2 RANKING --- ##
total_nagel = NagelkerkeR2(fit_dead)[["R2"]]
delta_nagel <- list(((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -AGE))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -GENDER))[["R2"]])/total_nagel)*100)
install.packages(fmsb)
install.packages("fmsb")
library(bnlearn)
library(Rgraphviz)
library(fmsb)
library(pROC)
data <- read.csv("Master_Tables/MASTER_TABLE.csv", header=TRUE)
no_shock_data = (subset(data, data$IN_SHOCK == 0))
shock_data = (subset(data, data$IN_SHOCK == 1))
## --- GENERALIZED LINEAR MODELS ---
fit_dead = glm(formula = DEAD ~ . - HADM_ID - ICUSTAY_ID - LOS_HOSPITAL - LOS_ICU - IN_SHOCK -
MULTIPLE_SCI - COMORBIDITIES, family = binomial, data=shock_data)
summary(fit_dead)
fit_los = glm(formula = LOS_ICU ~ . - HADM_ID - ICUSTAY_ID - LOS_HOSPITAL - DEAD - IN_SHOCK -
MULTIPLE_SCI - COMORBIDITIES, family = gaussian, data=shock_data)
summary(fit_los)
## --- NAGELKERKE R^2 RANKING --- ##
total_nagel = NagelkerkeR2(fit_dead)[["R2"]]
delta_nagel <- list(((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -AGE))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -GENDER))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -RESPIRATION))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -RENAL))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -LIVER))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -COAGULATION))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CNS))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -SPINAL_LEVEL))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -EC_ES_INJURY))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -GCS))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_CARDIOVASCULAR))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_LIVER.COAG))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_PULMONARY))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_DIABETES))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_FLUID_ELECTROLYTE))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_OTHER))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_ALCOHOL_ABUSE))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_MENTAL_HEALTH))[["R2"]])/total_nagel)*100)
delta_nagel
table(delta_nagel)
h <- hist(delta_nagel)
total_nagel2 = NagelkerkeR2(fit_los)[["R2"]]
fit_los_sofa.glm = glm(LOS_ICU ~ AGE + COMORBIDITIES + GENDER + RESPIRATION + RENAL + LIVER + COAGULATION
+ CNS + SPINAL_LEVEL + EC_ES_INJURY, family=gaussian, data=subset(sofa_df, sofa_df$IN_SHOCK == 1))
fitdi_los = glm(formula = LOS_ICU ~ . - HADM_ID - ICUSTAY_ID - LOS_HOSPITAL - DEAD - IN_SHOCK -
MULTIPLE_SCI - COMORBIDITIES, family = binomial, data=shock_data)
temp_data = data.frame(subset(data, data$IN_SHOCK == 1))
bn_death$AGE = cut(bn_death$AGE, breaks=c(0,50,70,90), right=FALSE, labels=FALSE)
temp_data = data.frame(subset(data, data$IN_SHOCK == 1))
temp_data$LOS_ICU = cut(temp_data$LOS_ICU, breaks=c(2), right=FALSE, labels=FALSE)
table(temp_data$LOS_ICU)
temp_data = data.frame(subset(data, data$IN_SHOCK == 1))
temp_data$LOS_ICU = cut(temp_data$LOS_ICU, breaks=c(2), right=FALSE, labels=FALSE)
table(temp_data$LOS_ICU)
temp_data = data.frame(subset(data, data$IN_SHOCK == 1))
temp_data$LOS_ICU = cut(temp_data$LOS_ICU, breaks=c(1), right=FALSE, labels=FALSE)
temp_data = data.frame(subset(data, data$IN_SHOCK == 1))
temp_data$LOS_ICU = cut(temp_data$LOS_ICU, breaks=c(0,2,99), right=FALSE, labels=FALSE)
table(temp_data$LOS_ICU)
names(temp_data)
temp_data = data.frame(subset(data, data$IN_SHOCK == 1))
temp_data$LOS_ICU = cut(temp_data$LOS_ICU, breaks=c(0,2,99), right=FALSE, labels=FALSE)
fitdi_los = glm(formula = LOS_ICU ~ . - HADM_ID - ICUSTAY_ID - LOS_HOSPITAL - DEAD - IN_SHOCK -
MULTIPLE_SCI - COMORBIDITIES, family = binomial, data=temp_data)
table(temp_data$LOS_ICU)
temp_data = data.frame(subset(data, data$IN_SHOCK == 1))
temp_data$LOS_ICU = cut(temp_data$LOS_ICU, breaks=c(0,2,99), right=FALSE, labels=c(0,1))
table(temp_data$LOS_ICU)
fitdi_los = glm(formula = LOS_ICU ~ . - HADM_ID - ICUSTAY_ID - LOS_HOSPITAL - DEAD - IN_SHOCK -
MULTIPLE_SCI - COMORBIDITIES, family = binomial, data=temp_data)
total_nagel2 = NagelkerkeR2(fitdi_los)[["R2"]]
delta_nagel2 <- list(((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -AGE))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -GENDER))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -RESPIRATION))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -RENAL))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -LIVER))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -COAGULATION))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CNS))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -SPINAL_LEVEL))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -EC_ES_INJURY))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -GCS))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_CARDIOVASCULAR))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_LIVER.COAG))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_PULMONARY))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_DIABETES))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_FLUID_ELECTROLYTE))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_OTHER))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_ALCOHOL_ABUSE))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_MENTAL_HEALTH))[["R2"]])/total_nagel2)*100)
library(bnlearn)
library(Rgraphviz)
library(fmsb)
library(pROC)
data <- read.csv("Master_Tables/MASTER_TABLE.csv", header=TRUE)
no_shock_data = (subset(data, data$IN_SHOCK == 0))
shock_data = (subset(data, data$IN_SHOCK == 1))
## --- GENERALIZED LINEAR MODELS ---
fit_dead = glm(formula = DEAD ~ . - HADM_ID - ICUSTAY_ID - LOS_HOSPITAL - LOS_ICU - IN_SHOCK -
MULTIPLE_SCI - COMORBIDITIES, family = binomial, data=shock_data)
summary(fit_dead)
fit_los = glm(formula = LOS_ICU ~ . - HADM_ID - ICUSTAY_ID - LOS_HOSPITAL - DEAD - IN_SHOCK -
MULTIPLE_SCI - COMORBIDITIES, family = gaussian, data=shock_data)
summary(fit_los)
## --- NAGELKERKE R^2 RANKING --- ##
total_nagel = NagelkerkeR2(fit_dead)[["R2"]]
delta_nagel <- list(((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -AGE))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -GENDER))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -RESPIRATION))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -RENAL))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -LIVER))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -COAGULATION))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CNS))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -SPINAL_LEVEL))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -EC_ES_INJURY))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -GCS))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_CARDIOVASCULAR))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_LIVER.COAG))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_PULMONARY))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_DIABETES))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_FLUID_ELECTROLYTE))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_OTHER))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_ALCOHOL_ABUSE))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_MENTAL_HEALTH))[["R2"]])/total_nagel)*100)
table(delta_nagel)
counts <- table(delta_nagel)
counts
barplot(counts,horiz=TRUE,names.arg=c("Age", "Gender", "Respiration", "Renal", "Liver", "Coagulation", "CNS", "Spinal Level", "EC_ES_Injury", "GCS", "CMB_CARDIOVASCULAR", "CMB_LIVER.COAG", "CMB_PULMONARY", "CMB_DIABETES", "CMB_FLUID_ELECTROLYTE", "CMB_OTHER", "CMB_ALCOHOL_ABUSE", "CMB_MENTAL_HEALTH"))
counts
counts = unlist(counts, recursive = TRUE, use.names = TRUE)
counts
barplot(counts,horiz=TRUE,names.arg=c("Age", "Gender", "Respiration", "Renal", "Liver", "Coagulation", "CNS", "Spinal Level", "EC_ES_Injury", "GCS", "CMB_CARDIOVASCULAR", "CMB_LIVER.COAG", "CMB_PULMONARY", "CMB_DIABETES", "CMB_FLUID_ELECTROLYTE", "CMB_OTHER", "CMB_ALCOHOL_ABUSE", "CMB_MENTAL_HEALTH"))
type(counts)
is.vector(counts)
is.vector(delta_nagel)
barplot(delta_nagel,horiz=TRUE,names.arg=c("Age", "Gender", "Respiration", "Renal", "Liver", "Coagulation", "CNS", "Spinal Level", "EC_ES_Injury", "GCS", "CMB_CARDIOVASCULAR", "CMB_LIVER.COAG", "CMB_PULMONARY", "CMB_DIABETES", "CMB_FLUID_ELECTROLYTE", "CMB_OTHER", "CMB_ALCOHOL_ABUSE", "CMB_MENTAL_HEALTH"))
barplot(as.data.frame(delta_nagel),horiz=TRUE,names.arg=c("Age", "Gender", "Respiration", "Renal", "Liver", "Coagulation", "CNS", "Spinal Level", "EC_ES_Injury", "GCS", "CMB_CARDIOVASCULAR", "CMB_LIVER.COAG", "CMB_PULMONARY", "CMB_DIABETES", "CMB_FLUID_ELECTROLYTE", "CMB_OTHER", "CMB_ALCOHOL_ABUSE", "CMB_MENTAL_HEALTH"))
barplot(as.matrix(as.data.frame(delta_nagel)),horiz=TRUE,names.arg=c("Age", "Gender", "Respiration", "Renal", "Liver", "Coagulation", "CNS", "Spinal Level", "EC_ES_Injury", "GCS", "CMB_CARDIOVASCULAR", "CMB_LIVER.COAG", "CMB_PULMONARY", "CMB_DIABETES", "CMB_FLUID_ELECTROLYTE", "CMB_OTHER", "CMB_ALCOHOL_ABUSE", "CMB_MENTAL_HEALTH"))
names(temp_data)
## --- NAGELKERKE R^2 RANKING --- ##
total_nagel = NagelkerkeR2(fit_dead)[["R2"]]
delta_nagel <- list(((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -AGE))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -GENDER))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -RESPIRATION))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -RENAL))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -LIVER))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -COAGULATION))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -SPINAL_LEVEL))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -EC_ES_INJURY))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -GCS))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_CARDIOVASCULAR))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_LIVER.COAG))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_PULMONARY))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_DIABETES))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_FLUID_ELECTROLYTE))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_OTHER))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_ALCOHOL_ABUSE))[["R2"]])/total_nagel)*100)
delta_nagel <- append(delta_nagel, ((total_nagel - NagelkerkeR2(update(fit_dead, . ~ . -CMB_MENTAL_HEALTH))[["R2"]])/total_nagel)*100)
temp_data = data.frame(subset(data, data$IN_SHOCK == 1))
temp_data$LOS_ICU = cut(temp_data$LOS_ICU, breaks=c(0,2,99), right=FALSE, labels=c(0,1))
fitdi_los = glm(formula = LOS_ICU ~ . - HADM_ID - ICUSTAY_ID - LOS_HOSPITAL - DEAD - IN_SHOCK -
MULTIPLE_SCI - COMORBIDITIES, family = binomial, data=temp_data)
total_nagel2 = NagelkerkeR2(fitdi_los)[["R2"]]
delta_nagel2 <- list(((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -AGE))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -GENDER))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -RESPIRATION))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -RENAL))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -LIVER))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -COAGULATION))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CNS))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -SPINAL_LEVEL))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -EC_ES_INJURY))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -GCS))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_CARDIOVASCULAR))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_LIVER.COAG))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_PULMONARY))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_DIABETES))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_FLUID_ELECTROLYTE))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_OTHER))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_ALCOHOL_ABUSE))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_MENTAL_HEALTH))[["R2"]])/total_nagel2)*100)
total_nagel2 = NagelkerkeR2(fitdi_los)[["R2"]]
delta_nagel2 <- list(((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -AGE))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -GENDER))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -RESPIRATION))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -RENAL))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -LIVER))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -COAGULATION))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -SPINAL_LEVEL))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -EC_ES_INJURY))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -GCS))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_CARDIOVASCULAR))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_LIVER.COAG))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_PULMONARY))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_DIABETES))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_FLUID_ELECTROLYTE))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_OTHER))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_ALCOHOL_ABUSE))[["R2"]])/total_nagel2)*100)
delta_nagel2 <- append(delta_nagel2, ((total_nagel2 - NagelkerkeR2(update(fitdi_los, . ~ . -CMB_MENTAL_HEALTH))[["R2"]])/total_nagel2)*100)
names(data)
library(bnlearn)
library(Rgraphviz)
library(fmsb)
library(pROC)
data <- read.csv("Master_Tables/MASTER_TABLE.csv", header=TRUE)
no_shock_data = (subset(data, data$IN_SHOCK == 0))
shock_data = (subset(data, data$IN_SHOCK == 1))
plot(shock_data$AGE, shock_data$SOFA)
abline(lm(shock_data$AGE, shock_data$SOFA), col="red")
abline(lm(shock_data$AGE ~ shock_data$SOFA), col="red")
abline(lm(shock_data$AGE ~ shock_data$SOFA), col="red")
plot(shock_data$AGE, shock_data$SOFA)
abline(lm(shock_data$AGE ~ shock_data$SOFA), col="red")
abline(lm(shock_data$SOFA ~ shock_data$AGE), col="red")
